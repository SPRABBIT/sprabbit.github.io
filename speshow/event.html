<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>事件响应 - SpeShow 文档</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="keywords" content="Node.js,SpeShow,SpeShow.js,galgame引擎,AVG引擎,同人游戏,同人社团,游戏引擎,Galgame,AVG,SPRABBIT,SPENGINE" />
	<meta name="description" content="SpeShow.js是一个基于DirectX的Node.js可视化程序构建方案、AVG引擎、图文演示程序脚本引擎" />

	<link rel="icon" href="favicon.png">
	<link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap/3.2.0/css/bootstrap.min.css">
	<link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">

	<!-- syntax highlighting CSS -->
	<link rel="stylesheet" href="/css/syntax.css">
	<link rel="stylesheet" href="/css/custom.css">
	<link rel="stylesheet" href="/css/shCore.css" type="text/css" />
	<link rel="stylesheet" href="/css/shThemeFadeToGrey.css" type="text/css" />
	<link rel="stylesheet" href="/css/spengine.css" type="text/css" />
	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
      <script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

	<body data-spy="scroll" data-target=".sidebar">
	<div class="navbar navbar-inverse navbar-static-top" role="navigation">
		<div class="container">
			<div class="navbar-header">
				<a href="/speshow/">
					<img src="/images/logo_speshow_long_xs.png">
				</a>
			</div>
			<div class="collapse navbar-collapse">
				<ul class="nav navbar-nav">
					<li><a href="/speshow/">简介</a>
					</li>
					<li><a href="/speshow/docs.html">文档</a>
					</li>
					<li><a href="/">SPRABBIT主页</a>
					</li>
				</ul>
			</div>
			<!--/.nav-collapse -->
		</div>
	</div>

	<div class="container">
		<div class="row">
			<div class="col-md-3">
				<div data-spy="affix" data-offset-top="70" class="navbar hidden-print hidden-xs hidden-sm affix-top" role="complementary">
					<ul class="nav sidebar">
	<li><a href="index.html">SpeShow.JS 简介</a>
	</li>
	<li>
		<a href="docs.html">文档</a>
		<ul class="nav">
			<li>
				<a href="quick_start.html">快速入门</a>
				<ul class="nav">
					<li><a href="#hello_world">Hello World</a>
					</li>
					<li><a href="#hello_component">Hello 组件</a>
					</li>
					<li><a href="#hello_file">Hello 脚本文件</a>
					</li>
				</ul>
			</li>
			<li>
				<a href="deployment.html">部署 SpeShow</a>
				<ul class="nav">
					<li><a href="#init">入口文件</a>
					</li>
					<li><a href="#debug">调试模式</a>
					</li>
					<li><a href="#config">配置文件</a>
					</li>
				</ul>
			</li>
			<li>
				<a href="javascript.html">JavaScript</a>
				<ul class="nav">
					<li><a href="#node.js">Node.js</a>
					</li>
					<li><a href="#speshow_mod">SpeShow 模块</a>
					</li>
				</ul>
			</li>
			<li>
				<a href="speshow_module.html">SpeShow 模块</a>
				<ul class="nav">
					<li><a href="#jump">脚本文件引入及跳转</a>
					</li>
					<li><a href="#queue_func">队列函数</a>
					</li>
                    <li><a href="#register_font">注册字体</a>
					</li>
					<li><a href="#variable_type">系统变量与屏幕变量</a>
					</li>
					<li><a href="#state_saving">状态保存</a>
					</li>
				</ul>
			</li>
			<li>
				<a href="script_type.html">脚本分类</a>
				<ul class="nav">
					<li><a href="#normal_script">一般脚本</a>
					</li>
					<li><a href="#queued_script">队列脚本</a>
					</li>
				</ul>
			</li>
			<li>
				<a href="window.html">窗口</a>
				<ul class="nav">
					<li><a href="#title">标题</a>
					</li>
					<li><a href="#resize">窗口大小</a>
					</li>
					<li><a href="#cursor">指针</a>
					</li>
					<li><a href="#fps">FPS</a>
					</li>
					<li><a href="#onexit">退出事件</a>
					</li>
				</ul>
			</li>
			<li>
				<a href="screen.html">屏幕</a>
				<ul class="nav">
					<li><a href="#root">根组件</a>
					</li>
					<li><a href="#focus">聚焦</a>
					</li>					
					<li><a href="#capture">截图</a>
					</li>
					<li><a href="#create_component">创建组件</a>
					</li>
				</ul>
			</li>
			<li>
				<a href="component.html">UI组件</a>
				<ul class="nav">
					<li><a href="#normal_component">基本组件</a>
					</li>
					<li><a href="#animation">动画</a>
					</li>
					<li><a href="#effect">特效</a>
					</li>
					<li><a href="#picturebox">图片框</a>
					</li>
					<li><a href="#textbox">文字框</a>
					</li>
					<li><a href="#dialogbox">AVG对话框</a>
					</li>
                    <li><a href="#scroll">滚动框（列表）</a>
					</li>
				</ul>
			</li>
			<li>
				<a href="event.html">事件响应</a>
				<ul class="nav">
					<li><a href="#propagation">事件传递</a>
					</li>
					<li><a href="#event_handling">事件处理</a>
					</li>
					<li><a href="#event_type">事件类型</a>
					</li>
				</ul>
			</li>
			<li>
				<a href="multimedia.html">多媒体</a>
				<ul class="nav">
					<li><a href="#sound">音频</a>
					</li>
					<li><a href="#video">视频</a>
					</li>
					<li><a href="#sprite">精灵动画</a>
					</li>
					<li><a href="#particle">粒子系统</a>
					</li>
				</ul>
			</li>
			<li>
				<a href="advanced.html">进阶指南</a>
				<ul class="nav">
					<li><a href="#customize_effect">自定义特效</a>
					</li>
					<li><a href="#packing">打包资源文件</a>
					</li>
					<li><a href="#customize_packing">修改打包加密方法</a>
					</li>
				</ul>
			</li>
			<li><a href="reference.html">索引</a>
			</li>
			<li><a href="sample.html">示例</a>
			</li>
		</ul>
	</li>
	<li> <a href="show.html">演示</a>
	</li>
	<li><a href="license.html">使用许可</a>
	</li>
	<li>
		<a href="download.html">下载</a>
		<ul class="nav">
			<li><a href="download.html">SpeShow</a>
			</li>
			<li><a href="pack_guider.html">SSPackGuider</a>
			</li>
			<li><a href="editor.html">编辑器推荐</a>
			</li>
		</ul>
	</li>
	<li> <a href="donate.html">捐赠</a>
	</li>
	<li> <a href="FAQ.html">FAQ</a>
	</li>
	<li class="warn-new-doc">
		<a href="/spengine/">
			旧版文档(KS版本)
		</a>
	</li>
</ul>

				</div>
			</div>
			<div class="col-md-9 content-main" role="main">
				<h2>事件响应</h2>

<p>事件是在某些UI交互发生的时候所触发的信号，比如鼠标点击，键盘按键，鼠标移动等。用户可以通过设置UI组件的事件处理函数来处理这些事件带来的影响，比如当用户点击组件时让组件隐藏，只需要如下设置：</p>

<pre class="brush:js">
    // com 为一个组件对象
    com.onClick = function(e){
        this.display = false;
    }
</pre>

<hr>

<h3 id="propagation">事件传递</h3>

<p>事件的传递分为两个过程，一个是自顶向下的下沉，另一个是自底向上的冒泡。</p>

<p>事件发生时，将由 Screen 产生事件对象，然后从根组件开始往子孙组件深度优先地传递事件对象，若发现了合适的UI组件，则停止下沉，并自底向上冒泡地传递事件，直到事件对象返回根部。</p>

<hr>

<h3 id="event_handling">事件处理</h3>

<p>事件的处理使用事件处理函数，事件处理函数为接受一个参数的函数如上面提到的：</p>

<pre class="brush:js">
    // com 为一个组件对象
    com.onClick = function(e){
        this.display = false;
    }
</pre>

<p>参数 <code>e</code> 则为事件对象，他有以下属性：</p>

<table><tr><th>名称</th><th>类型</th><th>只读</th><th>描述</th></tr><tr><td>key</td><td>整数</td><td>是</td><td>若事件为键盘按键相关事件，则为按键的对应码值，具体对应关系见附表。<br/>若为鼠标按键事件，则：0-左键，1-右键，2-中键。</td></tr><tr><td>absoluteX</td><td>整数</td><td>是</td><td>若事件为鼠标移动相关事件，则为鼠标相对于窗口左上角的水平位移。</td></tr><tr><td>absoluteY</td><td>整数</td><td>是</td><td>若事件为鼠标移动相关事件，则为鼠标相对于窗口左上角的垂直位移。</td></tr><tr><td>x</td><td>整数</td><td>是</td><td>若事件为鼠标移动相关事件，则为鼠标相对于组件左上角的水平位移。</td></tr><tr><td>y</td><td>整数</td><td>是</td><td>若事件为鼠标移动相关事件，则为鼠标相对于组件左上角的垂直位移。</td></tr><tr><td>movementX</td><td>整数</td><td>是</td><td>若事件为鼠标移动相关事件，则为鼠标相对于上一个鼠标事件的水平位移。</td></tr><tr><td>movementY</td><td>整数</td><td>是</td><td>若事件为鼠标移动相关事件，则为鼠标相对于上一个鼠标事件的垂直位移。<br/>若为鼠标滚轮事件，则为滚轮滚动的方向。</td></tr><tr><td>returnValue</td><td>布尔值</td><td>否</td><td>是否继续事件传递，若为 false 则终止事件传递。</td></tr></table>

<p>其中键盘事件的 <code>key</code> 值见 <a href="#key">下方附表</a>。</p>

<p>因为事件传递有两个阶段，所以事件处理也有两个阶段，在事件下沉阶段的事件处理为事件捕获，使用以 <code>catch</code> 开头的事件处理器，如 <code>catchClick</code>：</p>

<pre class="brush:js">
    // com 为一个组件对象
    com.catchClick = function(e){
        // 处理事件
    }
</pre>

<p>在事件冒泡阶段的事件处理为一般事件处理，使用以 <code>on</code> 开头的事件处理器，如 <code>onClick</code>：</p>

<pre class="brush:js">
    // com 为一个组件对象
    com.onClick = function(e){
        // 处理事件
    }
</pre>

<p>终止事件传递有两种方法，第一种是直接在处器中返回 <code>false</code>：</p>

<pre class="brush:js">
    // com 为一个组件对象
    com.onClick = function(e){
        return false;
    }
</pre>

<p>另一种是将事件对象的 <code>returnValue</code> 属性设为 <code>false</code>：</p>

<pre class="brush:js">
    // com 为一个组件对象
    com.onClick = function(e){
        e.returnValue = false;
    }
</pre>

<hr>

<h3 id="event_type">事件类型</h3>

<p>事件的类型名为事件处理器 <code>on</code> 或 <code>catch</code> 后面的部分。</p>

<p>各个事件的解释如下：</p>

<table><tr><th>类型</th><th>描述</th></tr><tr><td>Click</td><td>鼠标在组件内点击时触发。</td></tr><tr><td>DClick</td><td>鼠标在组件内双击时触发。</td></tr><tr><td>MouseUp</td><td>鼠标按键在组件内弹起时触发。</td></tr><tr><td>MouseDown</td><td>鼠标按键在组件内按下时触发。</td></tr><tr><td>MouseScroll</td><td>鼠标滚轮在组件内滚动时触发。</td></tr><tr><td>MouseOver</td><td>鼠标停留在组件内时触发。</td></tr><tr><td>MouseIn</td><td>鼠标刚进入组件内时触发。</td></tr><tr><td>MouseOut</td><td>鼠标刚离开组件时触发。</td></tr><tr><td>KeyPress</td><td>键盘按键保持按下时触发。</td></tr><tr><td>KeyUp</td><td>键盘按键弹起时触发。</td></tr><tr><td>KeyDown</td><td>键盘按键按下时触发。</td></tr></table>

<hr>

<h3 id="key"> 附：键盘事件key值对照表</h3>

<table><tr><th>键名</th><th>对应按键</th><th>key值</th></tr><tr><td>ESCAPE</td><td>Esc</td><td>1</td></tr><tr><td>1</td><td>1</td><td>2</td></tr><tr><td>2</td><td>2</td><td>3</td></tr><tr><td>3</td><td>3</td><td>4</td></tr><tr><td>4</td><td>4</td><td>5</td></tr><tr><td>5</td><td>5</td><td>6</td></tr><tr><td>6</td><td>6</td><td>7</td></tr><tr><td>7</td><td>7</td><td>8</td></tr><tr><td>8</td><td>8</td><td>9</td></tr><tr><td>9</td><td>9</td><td>10</td></tr><tr><td>0</td><td>0</td><td>11</td></tr><tr><td>MINUS</td><td>-</td><td>12</td></tr><tr><td>EQUALS</td><td>=</td><td>13</td></tr><tr><td>BACK</td><td>退格</td><td>14</td></tr><tr><td>TAB</td><td>TAB</td><td>15</td></tr><tr><td>Q</td><td>Q</td><td>16</td></tr><tr><td>W</td><td>W</td><td>17</td></tr><tr><td>E</td><td>E</td><td>18</td></tr><tr><td>R</td><td>R</td><td>19</td></tr><tr><td>T</td><td>T</td><td>20</td></tr><tr><td>Y</td><td>Y</td><td>21</td></tr><tr><td>U</td><td>U</td><td>22</td></tr><tr><td>I</td><td>I</td><td>23</td></tr><tr><td>O</td><td>O</td><td>24</td></tr><tr><td>P</td><td>P</td><td>25</td></tr><tr><td>LBRACKET</td><td>[</td><td>26</td></tr><tr><td>RBRACKET</td><td>]</td><td>27</td></tr><tr><td>RETURN</td><td>回车</td><td>28</td></tr><tr><td>LCONTROL</td><td>左Ctrl</td><td>29</td></tr><tr><td>A</td><td>A</td><td>30</td></tr><tr><td>S</td><td>S</td><td>31</td></tr><tr><td>D</td><td>D</td><td>32</td></tr><tr><td>F</td><td>F</td><td>33</td></tr><tr><td>G</td><td>G</td><td>34</td></tr><tr><td>H</td><td>H</td><td>35</td></tr><tr><td>J</td><td>J</td><td>36</td></tr><tr><td>K</td><td>K</td><td>37</td></tr><tr><td>L</td><td>L</td><td>38</td></tr><tr><td>SEMICOLON</td><td>;</td><td>39</td></tr><tr><td>APOSTROPHE</td><td>'</td><td>40</td></tr><tr><td>GRAVE</td><td>`</td><td>41</td></tr><tr><td>LSHIFT</td><td>左Shift</td><td>42</td></tr><tr><td>BACKSLASH</td><td>\</td><td>43</td></tr><tr><td>Z</td><td>Z</td><td>44</td></tr><tr><td>X</td><td>X</td><td>45</td></tr><tr><td>C</td><td>C</td><td>46</td></tr><tr><td>V</td><td>V</td><td>47</td></tr><tr><td>B</td><td>B</td><td>48</td></tr><tr><td>N</td><td>N</td><td>49</td></tr><tr><td>M</td><td>M</td><td>50</td></tr><tr><td>COMMA</td><td>,</td><td>51</td></tr><tr><td>PERIOD</td><td>.</td><td>52</td></tr><tr><td>SLASH</td><td>/</td><td>53</td></tr><tr><td>RSHIFT</td><td>右Shift</td><td>54</td></tr><tr><td>MULTIPLY</td><td>左Ctrl</td><td>55</td></tr><tr><td>LMENU</td><td>左Alt</td><td>56</td></tr><tr><td>SPACE</td><td>空格</td><td>57</td></tr><tr><td>CAPITAL</td><td>右Ctrl</td><td>58</td></tr><tr><td>F1</td><td>F1</td><td>59</td></tr><tr><td>F2</td><td>F2</td><td>60</td></tr><tr><td>F3</td><td>F3</td><td>61</td></tr><tr><td>F4</td><td>F4</td><td>62</td></tr><tr><td>F5</td><td>F5</td><td>63</td></tr><tr><td>F6</td><td>F6</td><td>64</td></tr><tr><td>F7</td><td>F7</td><td>65</td></tr><tr><td>F8</td><td>F8</td><td>66</td></tr><tr><td>F9</td><td>F9</td><td>67</td></tr><tr><td>F10</td><td>F10</td><td>68</td></tr><tr><td>NUMLOCK</td><td>Num Lock</td><td>69</td></tr><tr><td>SCROLL</td><td>Scroll Lock</td><td>70</td></tr><tr><td>NUMPAD7</td><td>数字键盘7</td><td>71</td></tr><tr><td>NUMPAD8</td><td>数字键盘8</td><td>72</td></tr><tr><td>NUMPAD9</td><td>数字键盘9</td><td>73</td></tr><tr><td>SUBTRACT</td><td>数字键盘-</td><td>74</td></tr><tr><td>NUMPAD4</td><td>数字键盘4</td><td>75</td></tr><tr><td>NUMPAD5</td><td>数字键盘5</td><td>76</td></tr><tr><td>NUMPAD6</td><td>数字键盘6</td><td>77</td></tr><tr><td>ADD</td><td>数字键盘+</td><td>78</td></tr><tr><td>NUMPAD1</td><td>数字键盘1</td><td>79</td></tr><tr><td>NUMPAD2</td><td>数字键盘2</td><td>80</td></tr><tr><td>NUMPAD3</td><td>数字键盘3</td><td>81</td></tr><tr><td>NUMPAD0</td><td>数字键盘0</td><td>82</td></tr><tr><td>DECIMAL</td><td>数字键盘.</td><td>83</td></tr><tr><td>OEM_102</td><td> </td><td>84</td></tr><tr><td>MULTIPLY</td><td>数字键盘*</td><td>85</td></tr><tr><td>DIVIDE</td><td>数字键盘/</td><td>86</td></tr><tr><td>F11</td><td>F11</td><td>87</td></tr><tr><td>F12</td><td>F12</td><td>88</td></tr><tr><td>NUMPADEQUALS</td><td>数字键盘=</td><td>141</td></tr><tr><td>NUMPADENTER</td><td>数字键盘回车</td><td>156</td></tr><tr><td>HOME</td><td>Home</td><td>199</td></tr><tr><td>END</td><td>End</td><td>207</td></tr><tr><td>PRIOR</td><td>Page Up</td><td>201</td></tr><tr><td>NEXT</td><td>Page Down</td><td>209</td></tr><tr><td>INSERT</td><td>Insert</td><td>210</td></tr><tr><td>DELETE</td><td>Delete</td><td>211</td></tr><tr><td>UP</td><td>上箭头</td><td>200</td></tr><tr><td>LEFT</td><td>左箭头</td><td>203</td></tr><tr><td>RIGHT</td><td>右箭头</td><td>205</td></tr><tr><td>DOWN</td><td>下箭头</td><td>208</td></tr><tr><td>LWIN</td><td>左徽标</td><td>219</td></tr><tr><td>RWIN</td><td>右徽标</td><td>220</td></tr><tr><td>APPS</td><td>菜单</td><td>221</td></tr></table>

<hr>

<p>上一节：<a href="component.html">组件</a></p>

<p>下一节：<a href="multimedia.html">多媒体</a></p>

<hr>

<!-- UY BEGIN -->

<div id="uyan_frame"> </div>

<script type="text/javascript" defer="defer" id="UYScript" src="http://v1.uyan.cc/js/iframe.js?UYUserId=1589291" async=""></script>

<!-- UY END -->

			</div>	
		</div>
	</div>
	<!-- /.container -->

	<div role="contentinfo" class="footer">
		<div class="container copyright">
			<p>Copyright &copy; 2011-2014 <a href="http://www.sprabbit.com/">SPRABBIT</a></p>
			<p>Designed by <a href="http://kennethj.lofter.com/">Kenneth.J</a>. Built with <a href="http://getbootstrap.com/">Bootstrap</a>.</p>
		</div>
	</div>
</body>


<script src="http://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
<script src="http://cdn.bootcss.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>


<script type="text/javascript" src="/js/shCore.js"></script>

<script type="text/javascript" src="/js/shBrushXML.js"></script>

<script type="text/javascript" src="/js/shBrushJScript.js"></script>

<script type="text/javascript" src="/js/highlight.js"></script>

<script type="text/javascript" src="/js/spengine/nav_collapse.js"></script>

<script type="text/javascript" src="/js/baidu_tongji.js"></script>

</html>
